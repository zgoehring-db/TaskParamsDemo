FROM confluentinc/cp-kafka-connect:5.3.1
# Create plugin directory
RUN mkdir -p /usr/share/java/plugins
RUN mkdir -p /usr/share/java/kafka-connect-jdbc
# Add Snowflake connector jar
RUN curl -sSL "https://repo1.maven.org/maven2/com/snowflake/snowflake-kafka-connector/1.8.0/snowflake-kafka-connector-1.8.0.jar" -o /usr/share/java/plugins/snowflake-kafka-connector-1.8.0.jar
# Add Snowflake JDBC connector jar
RUN curl -sSL "https://repo1.maven.org/maven2/net/snowflake/snowflake-jdbc/3.10.3/snowflake-jdbc-3.10.3.jar" -o /usr/share/java/kafka-connect-jdbc/snowflake-jdbc-connector-3.10.3.jar
# Install the below jars 
RUN curl -sSL "https://repo1.maven.org/maven2/org/bouncycastle/bc-fips/1.0.1/bc-fips-1.0.1.jar" -o /etc/kafka-connect/jars/bc-fips-1.0.1.jar
RUN curl -sSL "https://repo1.maven.org/maven2/org/bouncycastle/bcpkix-fips/1.0.3/bcpkix-fips-1.0.3.jar" -o /etc/kafka-connect/jars/bcpkix-fips-1.0.3.jar
# copy the properties file
COPY sfdata.json /tmp
COPY bc-fips-1.0.1.jar /etc/kafka-connect/jars/
COPY bcpkix-fips-1.0.3.jar /etc/kafka-connect/jars/
# datagen config
ENV CONNECT_PLUGIN_PATH="/usr/share/java,/usr/share/confluent-hub-components"
RUN confluent-hub install --no-prompt confluentinc/kafka-connect-datagen:0.1.0
